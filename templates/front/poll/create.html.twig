{% extends "front/layout.html.twig" %}

{% block title %}Créer un sondage - {% endblock %}

{% block mainContent %}

    <div class="container poll">
        <span class="title">Ajouter un sondage</span>
        <div class="form">
            <div class="card">
                <div class="card-body">
                    {{ form_start(form) }}
                        <div class="form-group">
                            <div class="subtitle"> <i class="fal fa-sticky-note" style="margin-right: 5px;"></i> Titre du sondage</div>
                            {{ form_widget(form.title, {'attr': {'class': 'form-control', 'placeholder': 'Entrez un titre'}}) }}
                            {{ form_errors(form.title) }}
                        </div>

                        <div class="form-group">
                            <div class="subtitle"> <i class="fal fa-question-circle" style="margin-right: 5px;"></i> Votre question</div>
                            {{ form_widget(form.question, {'attr': {'class': 'form-control', 'placeholder': 'Entrez une question'}}) }}
                            {{ form_errors(form.question) }}
                        </div>

                        <div class="subtitle"> <i class="fal fa-list" style="margin-right: 5px;"></i> Vos réponses</div>
                        {{ form_widget(form.poll) }}
                        <div class="form-group">
                            <input class="form-control" type="text" name="form[poll][1]" placeholder="Entrez une première réponse" required/>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="text" name="form[poll][0]" placeholder="Entrez une deuxième réponse" required/>
                        </div>
                        <div class="input_fields_wrap"></div>
                        <button type="button" class="btn btn-secondary" id="add-field">Ajouter un champs</button>
                        <button type="submit" class="btn btn-primary">Créer le sondage</button>
                    {{ form_end(form) }}
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        var max_fields      = 11;
        var wrapper         = $(".input_fields_wrap");
        var add_button      = $("#add-field");
        var x = 2;

        $(add_button).click(function(e){
            e.preventDefault();
            if(x < max_fields){
                $(wrapper).append('' +
                    '<div class="form-group">' +
                    '<input placeholder="Réponse n°' + x + '" class="form-control added" type="text" name="form[poll][' + x + ']" required/>' +
                    '<a href="#" class="remove_field"><i class="fal fa-trash-alt"></i></a>' +
                    '</div>');
                x++;
            }
        });

        $(wrapper).on("click",".remove_field", function(e){ //user click on remove text
            e.preventDefault(); $(this).parent('div').remove(); x--;
        });
    </script>

{% endblock %}